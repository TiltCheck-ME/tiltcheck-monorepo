<!DOCTYPE html>
<!--
  © 2024–2025 TiltCheck Ecosystem. All Rights Reserved.
  Created by jmenichole (https://github.com/jmenichole)
  
  This file is part of the TiltCheck project.
  For licensing information, see LICENSE file in the project root.
-->

<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Casino Trust Score Grades - TiltCheck</title>
  <meta name="description"
    content="Live casino trust scores tracked by the TiltCheck Casino Trust Engine. Fairness, payouts, compliance, and bonus nerf data.">
  <meta name="theme-color" content="#00FFC6">
  <link rel="stylesheet" href="/styles/theme.css">
  <link rel="stylesheet" href="/styles/main.css">
  <style>
    .trust-scores-hero {
      background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      padding: clamp(3rem, 6vw, 4rem) var(--container-padding);
      text-align: center;
      border-bottom: 1px solid rgba(0, 255, 198, 0.12);
    }

    .trust-scores-hero h1 {
      font-size: var(--text-3xl);
      font-weight: var(--weight-black);
      font-family: var(--font-display);
      color: var(--text-primary);
      margin-bottom: var(--space-md);
    }

    .trust-scores-hero p {
      color: var(--text-secondary);
      font-size: var(--text-base);
      max-width: 600px;
      margin: 0 auto;
      line-height: var(--leading-relaxed);
    }

    .trust-scores-content {
      padding: clamp(2rem, 4vw, 3rem) var(--container-padding);
      max-width: var(--container-max);
      margin: 0 auto;
    }

    #trust-scores-loading {
      text-align: center;
      padding: var(--space-3xl);
      color: var(--text-muted);
    }

    .trust-table-wrapper {
      overflow-x: auto;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-subtle);
    }

    .trust-table {
      width: 100%;
      border-collapse: collapse;
      font-size: var(--text-sm);
    }

    .trust-table thead th {
      background: var(--bg-tertiary);
      color: var(--color-primary);
      padding: var(--space-md) var(--space-lg);
      text-align: left;
      font-weight: var(--weight-semibold);
      font-family: var(--font-mono);
      font-size: var(--text-xs);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      white-space: nowrap;
      border-bottom: 1px solid var(--border-emphasis);
    }

    .trust-table tbody td {
      padding: var(--space-md) var(--space-lg);
      border-bottom: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      vertical-align: middle;
    }

    .trust-table tbody tr:last-child td {
      border-bottom: none;
    }

    .trust-table tbody tr:hover td {
      background: var(--bg-secondary);
    }

    .casino-name {
      color: var(--text-primary);
      font-weight: var(--weight-semibold);
    }

    .score-cell {
      font-family: var(--font-mono);
      font-weight: var(--weight-bold);
    }

    .score-high {
      color: var(--color-positive);
    }

    .score-mid {
      color: var(--color-caution);
    }

    .score-low {
      color: var(--color-danger);
    }

    .events-cell {
      font-family: var(--font-mono);
      color: var(--text-muted);
    }

    .severity-badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 10px;
      border-radius: var(--radius-sm);
      font-size: var(--text-xs);
      font-weight: var(--weight-semibold);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-family: var(--font-mono);
    }

    .severity-low {
      background: rgba(76, 175, 80, 0.12);
      color: var(--color-positive);
      border: 1px solid var(--color-positive);
    }

    .severity-medium {
      background: rgba(255, 193, 7, 0.12);
      color: var(--color-caution);
      border: 1px solid var(--color-caution);
    }

    .severity-high {
      background: rgba(255, 82, 82, 0.12);
      color: var(--color-danger);
      border: 1px solid var(--color-danger);
    }

    .severity-unknown {
      background: rgba(107, 114, 128, 0.12);
      color: var(--text-muted);
      border: 1px solid var(--border-emphasis);
    }

    .empty-state {
      text-align: center;
      padding: var(--space-3xl) var(--container-padding);
      color: var(--text-muted);
    }

    .empty-state p {
      margin-bottom: var(--space-md);
    }

    .meta-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: var(--space-md);
      margin-bottom: var(--space-lg);
      color: var(--text-muted);
      font-size: var(--text-xs);
      font-family: var(--font-mono);
    }
  </style>
</head>

<body>
  <a href="#scores-main" class="skip-link">Skip to main content</a>
  <div id="shared-nav"></div>

  <main id="scores-main">

    <header class="trust-scores-hero">
      <div class="container">
        <h1 class="text-gradient-emerald">Casino Trust Scores</h1>
        <p>Live trust data from the TiltCheck Casino Trust Engine. Updated automatically as events are tracked across
          the ecosystem.</p>
      </div>
    </header>

    <!-- Interactive Trust Simulator -->
    <section class="trust-simulator container" style="margin-top: 40px; margin-bottom: 60px;">
      <div class="glass-panel" id="trustSimBoard"
        style="border-radius: 16px; padding: 40px; text-align: center; transition: all 0.5s ease;">
        <h2 style="margin-bottom: 20px; color: #fff;">Visualizing the Trust Scale</h2>
        <p style="color: #6B7280; margin-bottom: 30px;">Slide to see how we classify casino safety based on real-world
          signals.</p>

        <div style="max-width: 600px; margin: 0 auto;">
          <input type="range" id="trustSlider" min="0" max="100" value="85"
            style="width: 100%; height: 8px; border-radius: 4px; appearance: none; background: #374151; cursor: pointer; outline: none; margin-bottom: 40px;">

          <div id="simBadgeContainer" style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
            <div id="simScoreDisplay"
              style="font-size: 5rem; font-weight: 900; font-family: 'Space Grotesk', sans-serif;">85</div>
            <div id="simBadge" class="severity-badge" style="font-size: 1.2rem; padding: 8px 24px;">HIGH TRUST</div>
            <div id="simDesc" style="color: #B8C4CE; max-width: 400px; line-height: 1.6;">Verifiably fair, fast payouts,
              and transparent terms. Minimal risk.</div>
          </div>
        </div>
      </div>
    </section>

    <script>
      (function () {
        const slider = document.getElementById('trustSlider');
        const board = document.getElementById('trustSimBoard');
        const scoreDisplay = document.getElementById('simScoreDisplay');
        const badge = document.getElementById('simBadge');
        const desc = document.getElementById('simDesc');

        const configs = [
          { threshold: 40, label: 'HIGH RISK', color: '#FF5252', desc: 'Critical issues detected. Possible exit scam, withheld payouts, or falsified RTP.', glitch: true },
          { threshold: 60, label: 'CAUTION', color: '#FFC107', desc: 'Frequent bonus nerfs and slow support. Proceed with caution.', glitch: false },
          { threshold: 80, label: 'NEUTRAL', color: '#6B7280', desc: 'Standard operations. Some community complaints but overall stable.', glitch: false },
          { threshold: 95, label: 'HIGH TRUST', color: '#00FFC6', desc: 'Verifiably fair, fast payouts, and transparent terms. Minimal risk.', glitch: false },
          { threshold: 101, label: 'EMERALD GRADE', color: '#10B981', desc: 'Gold standard. Instant payouts, open-source provably fair modules, and zero-nerf history.', glitch: false, glow: true }
        ];

        slider.addEventListener('input', () => {
          const val = parseInt(slider.value);
          scoreDisplay.textContent = val;

          const conf = configs.find(c => val < c.threshold);

          badge.textContent = conf.label;
          badge.style.borderColor = conf.color;
          badge.style.color = conf.color;
          badge.style.background = conf.color + '1F';
          scoreDisplay.style.color = conf.color;
          desc.textContent = conf.desc;

          if (conf.glitch) {
            board.classList.add('glitch-hover');
            board.style.boxShadow = `0 0 40px ${conf.color}44`;
          } else {
            board.classList.remove('glitch-hover');
            board.style.boxShadow = conf.glow ? `0 0 50px ${conf.color}66` : '0 8px 32px 0 rgba(0, 0, 0, 0.37)';
          }

          if (conf.glow) {
            scoreDisplay.style.textShadow = `0 0 20px ${conf.color}`;
          } else {
            scoreDisplay.style.textShadow = 'none';
          }
        });
      })();
    </script>


    <section class="trust-scores-content" aria-labelledby="scores-table-title">
      <div class="meta-bar" id="scores-meta" aria-live="polite">
        <span>Loading data…</span>
      </div>

      <div id="trust-scores">
        <div id="trust-scores-loading">
          <p> Loading trust scores…</p>
        </div>
      </div>

      <p style="margin-top: var(--space-2xl); color: var(--text-muted); font-size: var(--text-xs); text-align: center;">
        Trust scores are computed from on-chain signals, payout data, community reports, and compliance checks.
        <a href="/trust-explained.html" style="color: var(--color-primary);">Learn how scoring works →</a>
      </p>
    </section>
  </main>

  <div id="shared-footer"></div>

  <script>
    (function () {
      const container = document.getElementById('trust-scores');
      const meta = document.getElementById('scores-meta');

      function severityClass(s) {
        if (!s) return 'severity-unknown';
        const sl = String(s).toLowerCase();
        if (sl === 'low') return 'severity-low';
        if (sl === 'medium') return 'severity-medium';
        if (sl === 'high' || sl === 'critical') return 'severity-high';
        return 'severity-unknown';
      }

      function scoreClass(score) {
        const n = parseFloat(score);
        if (isNaN(n)) return '';
        if (n >= 80) return 'score-high';
        if (n >= 50) return 'score-mid';
        return 'score-low';
      }

      fetch('/data/trust-rollups.json')
        .then(r => {
          if (!r.ok) throw new Error('Not found');
          return r.json();
        })
        .then(data => {
          const batches = data.batches || [];
          const latestBatch = batches[batches.length - 1];

          if (!latestBatch?.casino?.casinos || Object.keys(latestBatch.casino.casinos).length === 0) {
            container.innerHTML = `
              <div class="empty-state">
                <p>No casino trust scores yet.</p>
                <p><a href="/trust-explained.html" style="color: var(--color-primary);">Learn how trust scoring works →</a></p>
              </div>`;
            meta.textContent = 'No data available yet.';
            return;
          }

          const casinos = latestBatch.casino.casinos;
          const count = Object.keys(casinos).length;
          meta.innerHTML = `<span><strong style="color:var(--text-primary);">${count}</strong> casinos tracked</span><span>Batch: ${latestBatch.id || '—'}</span>`;

          let rows = '';
          for (const [name, info] of Object.entries(casinos)) {
            const score = info.lastScore ?? 'N/A';
            const events = info.events ?? '—';
            const severity = info.lastSeverity ?? null;
            rows += `
              <tr>
                <td class="casino-name">${name}</td>
                <td class="score-cell ${scoreClass(score)}">${score}</td>
                <td class="events-cell">${events}</td>
                <td><span class="severity-badge ${severityClass(severity)}">${severity || 'Unknown'}</span></td>
              </tr>`;
          }

          container.innerHTML = `
            <div class="trust-table-wrapper">
              <table class="trust-table" aria-label="Casino trust scores">
                <thead>
                  <tr>
                    <th scope="col">Casino</th>
                    <th scope="col">Trust Score</th>
                    <th scope="col">Events</th>
                    <th scope="col">Last Severity</th>
                  </tr>
                </thead>
                <tbody>${rows}</tbody>
              </table>
            </div>`;
        })
        .catch(() => {
          container.innerHTML = `
            <div class="empty-state">
              <p>Trust score data isn't available yet — the engine is warming up.</p>
              <p><a href="/casinos.html" style="color: var(--color-primary);">View the Casino Directory →</a></p>
            </div>`;
          meta.textContent = 'Data unavailable.';
        });
    })();
  </script>

  <script src="/scripts/components-loader.js"></script>
  <script src="/scripts/auth.js"></script>
</body>

</html>