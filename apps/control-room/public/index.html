<!DOCTYPE html>
<!--
  © 2024–2025 TiltCheck Ecosystem. All Rights Reserved.
  Created by jmenichole (https://github.com/jmenichole)
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TiltCheck Control Room</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="login-screen" class="login-overlay">
    <div class="login-box">
      <div class="login-logo">&#x1F39B;&#xFE0F;</div>
      <h1>Control Room</h1>
      <p class="login-subtitle">TiltCheck Admin Dashboard</p>
      <form id="login-form">
        <input type="password" id="password" placeholder="Admin password" autocomplete="current-password" required>
        <button type="submit" class="btn btn-primary btn-full">Unlock</button>
      </form>
      <div id="login-error" class="error-msg"></div>
    </div>
  </div>

  <div id="app" class="app hidden">
    <nav class="sidebar">
      <div class="sidebar-logo">
        <span class="logo-icon">&#x1F39B;&#xFE0F;</span>
        <span class="logo-text">Control Room</span>
      </div>
      <ul class="nav-links">
        <li><a href="#" class="nav-link active" data-tab="containers">&#x1F433; Containers</a></li>
        <li><a href="#" class="nav-link" data-tab="logs">&#x1F4CB; Logs</a></li>
        <li><a href="#" class="nav-link" data-tab="metrics">&#x1F4C8; Metrics</a></li>
        <li><a href="#" class="nav-link" data-tab="compose">&#x1F527; Compose</a></li>
      </ul>
      <div class="sidebar-footer">
        <div class="ws-indicator" id="ws-indicator">
          <span class="dot dot-off"></span> Disconnected
        </div>
        <button class="btn btn-ghost btn-sm" onclick="logout()">Logout</button>
      </div>
    </nav>

    <main class="main-content">
      <header class="topbar">
        <div class="topbar-left">
          <h2 id="tab-title">Containers</h2>
          <span id="last-updated" class="muted"></span>
        </div>
        <div class="topbar-right">
          <span id="clock" class="clock"></span>
          <button class="btn btn-sm btn-secondary" onclick="refreshAll()">&#x21BA; Refresh</button>
        </div>
      </header>

      <!-- Containers Tab -->
      <section id="tab-containers" class="tab active">
        <div class="summary-bar">
          <div class="summary-card">
            <span class="sum-num" id="sum-running">&#x2014;</span>
            <span class="sum-label">Running</span>
          </div>
          <div class="summary-card">
            <span class="sum-num" id="sum-stopped">&#x2014;</span>
            <span class="sum-label">Stopped</span>
          </div>
          <div class="summary-card">
            <span class="sum-num" id="sum-missing">&#x2014;</span>
            <span class="sum-label">Missing</span>
          </div>
          <div class="summary-actions">
            <button class="btn btn-warning btn-sm" onclick="restartAll()">&#x21BA; Restart All</button>
          </div>
        </div>
        <div id="container-grid" class="container-grid">
          <div class="loading-msg">Loading containers...</div>
        </div>
      </section>

      <!-- Logs Tab -->
      <section id="tab-logs" class="tab hidden">
        <div class="logs-layout">
          <div class="logs-sidebar">
            <div class="logs-sidebar-header">Containers</div>
            <div id="logs-container-list" class="logs-container-list"></div>
          </div>
          <div class="logs-main">
            <div class="logs-toolbar">
              <span id="logs-container-name" class="muted">No container selected</span>
              <div class="logs-toolbar-actions">
                <label class="toggle-label">
                  <input type="checkbox" id="live-toggle"> Live tail
                </label>
                <select id="logs-lines" class="select-sm">
                  <option value="50">50 lines</option>
                  <option value="150" selected>150 lines</option>
                  <option value="300">300 lines</option>
                  <option value="500">500 lines</option>
                </select>
                <button class="btn btn-sm btn-secondary" onclick="fetchLogs()">Load</button>
                <button class="btn btn-sm btn-ghost" onclick="clearLogs()">Clear</button>
              </div>
            </div>
            <div id="log-output" class="log-output">
              <div class="log-placeholder">Select a container to view logs</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Metrics Tab -->
      <section id="tab-metrics" class="tab hidden">
        <div class="metrics-grid">
          <div class="metric-card">
            <div class="metric-icon">&#x23F1;&#xFE0F;</div>
            <div class="metric-body">
              <div class="metric-label">Uptime</div>
              <div class="metric-value" id="m-uptime">&#x2014;</div>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">&#x26A1;</div>
            <div class="metric-body">
              <div class="metric-label">Load Average</div>
              <div class="metric-value" id="m-load">&#x2014;</div>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">&#x1F9E0;</div>
            <div class="metric-body">
              <div class="metric-label">Memory</div>
              <div class="metric-value" id="m-mem">&#x2014;</div>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">&#x1F4BE;</div>
            <div class="metric-body">
              <div class="metric-label">Disk</div>
              <div class="metric-value" id="m-disk">&#x2014;</div>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">&#x1F433;</div>
            <div class="metric-body">
              <div class="metric-label">Docker Version</div>
              <div class="metric-value" id="m-docker">&#x2014;</div>
            </div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">&#x1F4E6;</div>
            <div class="metric-body">
              <div class="metric-label">Containers</div>
              <div class="metric-value" id="m-containers">&#x2014;</div>
            </div>
          </div>
        </div>
        <div class="panel mt-lg">
          <div class="panel-header">
            <h3>Per-Container Stats</h3>
            <span class="muted" id="stats-updated"></span>
          </div>
          <div id="per-container-stats" class="stats-table-wrap">
            <div class="loading-msg">Loading...</div>
          </div>
        </div>
      </section>

      <!-- Compose Tab -->
      <section id="tab-compose" class="tab hidden">
        <div class="compose-grid">
          <div class="panel">
            <div class="panel-header"><h3>Docker Compose Actions</h3></div>
            <p class="muted mb-md">Runs against the compose file on the VPS (<code>/app</code> directory).</p>
            <div class="compose-actions">
              <button class="btn btn-primary" onclick="composeAction('up')">&#9654; Up (deploy all)</button>
              <button class="btn btn-secondary" onclick="composeAction('ps')">&#128203; Status (ps)</button>
              <button class="btn btn-warning" onclick="composeAction('pull')">&#8595; Pull images</button>
              <button class="btn btn-danger" onclick="composeAction('down')">&#9632; Down (stop all)</button>
            </div>
          </div>
          <div class="panel">
            <div class="panel-header">
              <h3>Output</h3>
              <button class="btn btn-ghost btn-sm" onclick="clearComposeOutput()">Clear</button>
            </div>
            <pre id="compose-output" class="compose-output">No output yet.</pre>
          </div>
        </div>
      </section>
    </main>
  </div>

  <div id="toast" class="toast hidden"></div>
  <script src="/js/app.js"></script>
</body>
</html>
